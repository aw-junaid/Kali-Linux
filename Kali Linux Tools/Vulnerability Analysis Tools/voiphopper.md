![voiphopper.png](https://github.com/aw-junaid/Kali-Linux/blob/main/Kali%20Linux%20Tools/Images/Vulnerability%20Analysis%20Tools/voiphopper.png)

**VoIPHopper** is a security tool designed to test the security of **Voice over IP (VoIP)** networks by exploiting vulnerabilities in the **Dynamic Host Configuration Protocol (DHCP)** and **Cisco Discovery Protocol (CDP)**. It is specifically used to perform **VLAN hopping** attacks, which allow an attacker to gain unauthorized access to VLANs (Virtual Local Area Networks) that are otherwise isolated.

VoIP networks often use VLANs to separate voice traffic from data traffic for better performance and security. VoIPHopper simulates the behavior of VoIP devices (like IP phones) to trick network switches into assigning it to the voice VLAN, thereby bypassing network segmentation.


### **Key Features of VoIPHopper**
1. **VLAN Hopping**:
   - Exploits DHCP and CDP to gain access to voice VLANs.
2. **Automated Attacks**:
   - Automatically detects and exploits VLAN configurations.
3. **Compatibility**:
   - Works with Cisco switches and other VoIP-enabled network devices.
4. **Security Testing**:
   - Helps network administrators identify and fix VLAN misconfigurations.


### **How VoIPHopper Works**
1. **DHCP Exploitation**:
   - VoIPHopper sends DHCP requests to the network, pretending to be a VoIP device (like an IP phone).
   - The switch assigns it an IP address and places it in the voice VLAN.

2. **CDP Exploitation**:
   - VoIPHopper sends Cisco Discovery Protocol (CDP) packets to the network.
   - CDP is used by Cisco devices to share information about their capabilities and VLAN configurations.
   - By mimicking a VoIP device, VoIPHopper tricks the switch into revealing VLAN details.

3. **VLAN Access**:
   - Once in the voice VLAN, the attacker can intercept voice traffic, launch further attacks, or move laterally within the network.


### **Installation**
VoIPHopper is typically included in penetration testing distributions like **Kali Linux**. To install it manually:
1. Download the source code from the official repository:
   ```bash
   git clone https://github.com/iknowjason/voiphopper.git
   ```
2. Navigate to the directory:
   ```bash
   cd voiphopper
   ```
3. Compile the tool:
   ```bash
   make
   ```


### **Usage**
The general syntax is:
```bash
voiphopper [-i interface] [-d] [-c] [-v VLAN ID]
```


### **Options**
| Option          | Description                                                                 |
|-----------------|-----------------------------------------------------------------------------|
| `-i interface`  | Specify the network interface to use (e.g., `eth0`).                        |
| `-d`            | Enable DHCP-based VLAN hopping.                                             |
| `-c`            | Enable CDP-based VLAN hopping.                                              |
| `-v VLAN ID`    | Specify the target VLAN ID to join.                                         |
| `-h`            | Display help and exit.                                                      |


### **üîç Extended VoIP Hopper Usage Guide**  

## **‚öôÔ∏è Miscellaneous Options**
| Option | Description | Example |
|---------|-------------|------------|
| **`-l`** | List available interfaces for **CDP sniffing**, then exit. | `voiphopper -l` |
| **`-m`** | Spoof the MAC address, then exit. | `voiphopper -i eth0 -m 00:07:0E:EA:50:86` |
| **`-d`** | Delete the VLAN interface, then exit. | `voiphopper -d eth0.200` |
| **`-V`** | Print the VoIP Hopper version, then exit. | `voiphopper -V` |



## **üñ•Ô∏è MAC Address Spoofing Options**
| Option | Description | Example |
|---------|-------------|------------|
| **`-m`** | Spoof both the **existing interface and new VLAN interface**. | `voiphopper -i eth0 -m 00:07:0E:EA:50:86` |
| **`-D -m`** | Spoof **only** the new VLAN interface. | `voiphopper -i eth0 -D -m 00:07:0E:EA:50:86` |


## **üì° CDP (Cisco Discovery Protocol) Modes**
CDP is used to discover VLAN information and spoof Cisco IP phones.

| Mode | Description | Example |
|---------|-------------|------------|
| **`-c 0`** | CDP **Sniff Mode** ‚Äì captures CDP packets to gather VLAN information. | `voiphopper -i eth0 -c 0` |
| **`-c 1`** | CDP **Spoof Mode** ‚Äì impersonates a Cisco IP phone. | `voiphopper -i eth0 -c 1 -E 'SEP00070EEA5086' -P 'Port 1' -C Host -L 'Cisco IP Phone 7940' -S 'P003-08-8-00' -U 1` |

### **üìå CDP Spoof Mode (`-c 1`) - Additional Options**
| Option | Description |
|---------|-------------|
| **`-E <string>`** | Device ID (e.g., **SIP00070EEA5086** for SIP phones, **SEP00070EEA5086** for SCCP phones). |
| **`-P <string>`** | Port ID (e.g., **"Port 1"**). |
| **`-C <string>`** | Capabilities (e.g., **Host**). |
| **`-L <string>`** | Platform (e.g., **"Cisco IP Phone 7940"**). |
| **`-S <string>`** | Software Version (e.g., **"P003-08-8-00"**). |
| **`-U <string>`** | Duplex setting (1 = Full, 0 = Half). |

## **üìû Avaya VLAN Discovery Mode (`-a`)**
Used to discover VLANs in **Avaya VoIP networks** using DHCP.

| Example | Description |
|---------|-------------|
| `voiphopper -i eth0 -a` | Run Avaya VLAN discovery. |
| `voiphopper -i eth0 -a -m 00:07:0E:EA:50:86` | Run Avaya VLAN discovery with **MAC spoofing**. |


## **üé≠ VLAN Hopping Mode (`-v`)**
Attempts to **jump** from one VLAN to another.

| Example | Description |
|---------|-------------|
| `voiphopper -i eth0 -v 200` | Hop into VLAN **200**. |
| `voiphopper -i eth0 -v 200 -D -m 00:07:0E:EA:50:86` | VLAN hop + **MAC spoofing**. |


## **üè¢ Alcatel VLAN Discovery Mode (`-t`)**
Used to identify VLANs in **Alcatel VoIP environments**.

| Example | Description |
|---------|-------------|
| `voiphopper -i eth0 -t 0` | Run **Alcatel VLAN discovery mode 0**. |
| `voiphopper -i eth0 -t 1` | Run **Alcatel VLAN discovery mode 1**. |
| `voiphopper -i eth0 -t 0 -m 00:80:9f:ad:42:42` | Mode **0** with **MAC spoofing**. |
| `voiphopper -i eth0 -t 1 -m 00:80:9f:ad:42:42` | Mode **1** with **MAC spoofing**. |
| `voiphopper -i eth0 -t 2 -v 800` | Mode **2**, targeting VLAN **800**. |
| `voiphopper -i eth0 -t 2 -v 800 -m 00:80:9f:ad:42:42` | Mode **2** + VLAN **800** + **MAC spoofing**. |


### **Examples**

1. **DHCP-Based VLAN Hopping**:
   ```bash
   sudo voiphopper -i eth0 -d
   ```
   - This command uses DHCP to attempt VLAN hopping on the `eth0` interface.

2. **CDP-Based VLAN Hopping**:
   ```bash
   sudo voiphopper -i eth0 -c
   ```
   - This command uses CDP to attempt VLAN hopping on the `eth0` interface.

3. **Specify a Target VLAN**:
   ```bash
   sudo voiphopper -i eth0 -v 100
   ```
   - This command attempts to join VLAN `100` on the `eth0` interface.

4. **Combined DHCP and CDP Attack**:
   ```bash
   sudo voiphopper -i eth0 -d -c
   ```
   - This command uses both DHCP and CDP to maximize the chances of successful VLAN hopping.


### **Use Cases**
1. **Security Audits**:
   - Test the effectiveness of VLAN segmentation in VoIP networks.
2. **Penetration Testing**:
   - Identify vulnerabilities in network configurations.
3. **Network Hardening**:
   - Help administrators secure their VoIP infrastructure by identifying misconfigurations.



### **Defensive Measures**
To protect against VLAN hopping attacks:
1. **Disable Unused Ports**:
   - Configure unused switch ports to be in a shutdown state.
2. **Disable CDP**:
   - Disable CDP on ports where it is not needed.
3. **Use VLAN Access Control Lists (VACLs)**:
   - Restrict traffic between VLANs.
4. **Enable Port Security**:
   - Limit the number of MAC addresses allowed on a port.
5. **Use Private VLANs**:
   - Isolate devices within the same VLAN.



